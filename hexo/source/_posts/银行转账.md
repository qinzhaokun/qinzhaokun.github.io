承若独立完成！！

接口设计：

方法接口

1. 登录接口（input: 账户名, 密码， output: 成功或者失败)

2. 显示余额接口 (input: 账户id: output: 账户名，余额)  查询数据库，显示该用户的资金余额

3. 验证账户的有效性接口(input: 账号，姓名 output:有效或失效)(可以考虑是否被冻结，账户不存在情况等)  判断转出用户是否是有效的

4. 验证是否可以转账(input: 账户id，转账金额 output: 可转或不可转) 判断余额是否大于等于转出金额

5. 转账执行接口(input: 转入id, 转出id, 金额, output: 成功或者失败) 转出账户减money， 转入账户加上money， 保证原子性

6. 操作记录接口(input: 流水号，转入id, 转出id, 金额，操作员) 记录交易日志

7. 校验接口(input: 转入账户id,转出账户id, 总金额 output: 成功或者失败) 重新查询数据库，保证两个账户数据的一致性

8. 锁定账户接口(input:账户id, output: 成功或者失败) 把对应数据库中两个账户的信息锁住，避免其他线程修改数据导致错误

9. 计算两个账户的总额接口(input:账户id1，账户id2 output: 余额和) 计算两个账户的余额，保证数据的一致性

10. 退出登录(input: 账户名， output: 成功或者失败)

参数接口:

登录参数接口
1. class login {
  String userName;
  String password;
}

账户名参数接口

2. class Account{
  Long id;
  String userName;
  Long money;
}

转账执行参数接口

3. class transfer{
  Long outId;
  Long inId;
  Long money;
}

操作记录接口

4. class log{
  String liushui;
  Long inId;
  Long outId;
  Long money;
  Date timestamp;
}

校验接口

5. class jiaoyan{
  Long inId;
  Long outId;
  Long totalMoney;
}

前端接口

6. class Input{
  String liushui;
  String inAccount;
  String outAccount;
  Long money;
}





转账流程说明：
见附件里的图

额外说明：
1. 转出账户不能透支? 通过接口10，保证在数据库里的账户余额大于等于转出金额

2. 金额计算正确？接口9计算里两个转出前总余额，接口7校验了转账后两个账户的余额和是否和转账前的一致，保证了数据库的一致性。此外，还可以单独校验转入账户和转出账户是否正确

3. 每天转出10万笔。数据库采用行锁(innodb对应字段加索引)，函数的调用采用多线程方式,服务部署在多台服务器上，在确保数据一致的情况下保证高并发性。

4. 接口9，5，6，7这几个操作是同步的，具有原子性。(必要时回滚)







